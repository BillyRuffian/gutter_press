@import 'bootstrap/scss/bootstrap';
@import 'bootstrap-icons/font/bootstrap-icons';

/* ============================================
   DARK MODE STYLES
   ============================================ */

/* CSS Variables for theming */
:root {
  --bg-primary: #ffffff;
  --bg-secondary: #f8f9fa;
  --text-primary: #212529;
  --text-secondary: #6c757d;
  --text-muted: #6c757d;
  --border-color: #dee2e6;
  --navbar-bg: #ffffff;
  --navbar-text: #333333;
  --navbar-text-secondary: #666666;
  --card-bg: #ffffff;
  --footer-bg: #f8f9fa;
  --code-bg: rgba(0, 0, 0, 0.04);
  --hero-overlay-start: rgba(0, 0, 0, 0);
  --hero-overlay-mid: rgba(0, 0, 0, 0.3);
  --hero-overlay-end: rgba(0, 0, 0, 0.7);
  --link-color: #0d6efd;
  --link-hover-color: #0a58ca;
}

/* Dark mode color scheme */
@media (prefers-color-scheme: dark) {
  :root {
    --bg-primary: #1a1a1a;
    --bg-secondary: #2d2d2d;
    --text-primary: #e9ecef;
    --text-secondary: #adb5bd;
    --text-muted: #6c757d;
    --border-color: #495057;
    --navbar-bg: #000000;
    --navbar-text: #ffffff;
    --navbar-text-secondary: #e9ecef;
    --card-bg: #2d2d2d;
    --footer-bg: #1a1a1a;
    --code-bg: rgba(255, 255, 255, 0.1);
    --hero-overlay-start: rgba(0, 0, 0, 0.2);
    --hero-overlay-mid: rgba(0, 0, 0, 0.5);
    --hero-overlay-end: rgba(0, 0, 0, 0.85);
    --link-color: #6ea8fe;
    --link-hover-color: #9ec5fe;
  }

  /* Apply dark mode to body */
  body {
    background-color: var(--bg-primary);
    color: var(--text-primary);
  }

  /* Main content areas */
  main {
    background-color: var(--bg-primary);
  }

  /* Override Bootstrap utility classes for dark mode */
  .text-dark {
    color: var(--text-primary) !important;
  }

  .text-body {
    color: var(--text-primary) !important;
  }

  .text-black {
    color: var(--text-primary) !important;
  }

  .text-secondary {
    color: var(--text-secondary) !important;
  }

  /* Ensure headings are visible */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: var(--text-primary);
  }

  /* Ensure paragraphs inherit proper color */
  p {
    color: var(--text-primary);
  }

  /* Article and post content */
  article,
  .post-content,
  .lexxy-content {
    color: var(--text-primary);

    /* Ensure nested elements inherit proper colors */
    p,
    li,
    span,
    div {
      color: var(--text-primary);
    }

    /* Keep links distinct */
    a {
      color: var(--link-color);

      &:hover {
        color: var(--link-hover-color);
      }
    }

    /* But override text-dark links */
    a.text-dark {
      color: var(--link-color) !important;

      &:hover {
        color: var(--link-hover-color) !important;
      }
    }
  }

  /* Post/page titles that are links */
  .text-decoration-none.text-dark {
    color: var(--text-primary) !important;

    &:hover {
      color: var(--link-color) !important;
    }
  }

  /* Cards and panels */
  .card {
    background-color: var(--card-bg) !important;
    color: var(--text-primary) !important;
    border-color: var(--border-color);

    .card-body {
      background-color: transparent;
      color: var(--text-primary) !important;
    }

    .card-text {
      color: var(--text-primary) !important;
    }

    // Cards with border-0 class
    &.border-0 {
      background-color: var(--card-bg) !important;
      border-color: transparent;
    }

    // Card with shadow (common in management interface)
    &.shadow-sm,
    &.shadow {
      background-color: var(--card-bg) !important;
    }
  }

  /* Links */
  a {
    color: var(--link-color);

    &:hover {
      color: var(--link-hover-color);
    }
  }

  /* Navbar dark mode */
  .navbar.bg-dark:not(.bg-transparent) {
    background-color: var(--navbar-bg) !important;
    border-bottom: 1px solid var(--border-color);
  }

  .navbar.bg-dark:not(.bg-transparent) .navbar-brand {
    color: var(--navbar-text) !important;
  }

  .navbar.bg-dark:not(.bg-transparent) .nav-link {
    color: var(--navbar-text-secondary) !important;
  }

  .navbar.bg-dark:not(.bg-transparent) .nav-link:hover {
    color: var(--navbar-text) !important;
  }

  /* Footer dark mode */
  footer.bg-light {
    background-color: var(--footer-bg) !important;
    border-top: 1px solid var(--border-color);
    color: var(--text-primary);
  }

  .text-muted {
    color: var(--text-secondary) !important;
  }

  /* Small text elements */
  small,
  .small {
    color: var(--text-secondary);
  }

  /* Hero overlay adjustments for dark mode */
  .hero-overlay {
    background: linear-gradient(to bottom,
        var(--hero-overlay-start) 0%,
        var(--hero-overlay-mid) 70%,
        var(--hero-overlay-end) 100%);
  }

  /* Code blocks */
  code {
    background-color: var(--code-bg) !important;
    color: var(--text-primary);
  }

  pre {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
  }

  /* Buttons */
  .btn-outline-secondary {
    color: var(--text-secondary);
    border-color: var(--border-color);

    &:hover {
      background-color: var(--bg-secondary);
      color: var(--text-primary);
    }
  }

  .btn-outline-primary {
    color: var(--link-color);
    border-color: var(--link-color);

    &:hover {
      background-color: var(--link-color);
      color: #ffffff;
    }
  }

  /* Alerts */
  .alert-success {
    background-color: #1e4d2b;
    color: #a3cfbb;
    border-color: #2d5a3d;
  }

  .alert-danger {
    background-color: #58151c;
    color: #ea868f;
    border-color: #842029;
  }

  /* Forms */
  .form-control,
  .form-select {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);

    &:focus {
      background-color: var(--bg-secondary);
      color: var(--text-primary);
      border-color: var(--link-color);
    }
  }

  /* Tables */
  .table {
    color: var(--text-primary);
    border-color: var(--border-color);

    th,
    td {
      border-color: var(--border-color);
    }
  }

  /* Borders */
  .border-top {
    border-color: var(--border-color) !important;
  }

  hr {
    color: var(--border-color);
    opacity: 1;
  }

  /* Attribution overlay */
  .attribution {
    background-color: rgba(0, 0, 0, 0.8);

    a {
      color: var(--text-secondary) !important;
    }
  }

  /* Loading image placeholder */
  .loading-image {
    background-color: var(--bg-secondary);
    background-image: linear-gradient(90deg, var(--border-color) 25%, transparent 25%),
      linear-gradient(var(--border-color) 50%, transparent 50%);
  }

  /* Lexxy content adjustments */
  .lexxy-content {
    code {
      background-color: var(--code-bg) !important;
    }
  }

  /* Attachment captions */
  .attachment__caption {
    color: var(--text-secondary);
  }

  /* Ensure images don't look too bright */
  img:not(.hero-bg) {
    opacity: 0.9;
  }

  /* Video controls */
  .attachment--video video {
    background-color: #000;
  }

  /* Bootstrap-specific dark mode adjustments */
  .bg-light {
    background-color: var(--bg-secondary) !important;
    color: var(--text-primary) !important;
  }

  .bg-white {
    background-color: var(--bg-primary) !important;
    color: var(--text-primary) !important;
  }

  .bg-body {
    background-color: var(--bg-primary) !important;
    color: var(--text-primary) !important;
  }

  .bg-transparent {
    background-color: transparent !important;
  }

  /* Specific background color overrides */
  .bg-dark {
    background-color: #000000 !important;
    color: var(--text-primary) !important;
  }

  /* Dropdown menus */
  .dropdown-menu {
    background-color: var(--card-bg);
    border-color: var(--border-color);
  }

  .dropdown-item {
    color: var(--text-primary);

    &:hover,
    &:focus {
      background-color: var(--bg-secondary);
      color: var(--text-primary);
    }
  }

  /* Pagination */
  .page-link {
    background-color: var(--bg-secondary);
    color: var(--link-color);
    border-color: var(--border-color);

    &:hover {
      background-color: var(--border-color);
      color: var(--link-hover-color);
      border-color: var(--border-color);
    }
  }

  .page-item.active .page-link {
    background-color: var(--link-color);
    border-color: var(--link-color);
    color: #ffffff;
  }

  .page-item.disabled .page-link {
    background-color: var(--bg-secondary);
    color: var(--text-muted);
    border-color: var(--border-color);
  }

  /* Navbar toggler */
  .navbar-toggler {
    border-color: var(--border-color);
  }

  .navbar-toggler-icon {
    filter: invert(1);
  }

  /* Search icon and other icons */
  .bi {
    color: var(--text-primary);
  }

  /* Icons in various contexts */
  .text-muted .bi {
    color: var(--text-secondary);
  }

  .btn .bi {
    // Icons in buttons should match button text color
    color: inherit;
  }

  /* Ensure Bootstrap icons are visible */
  i[class*="bi-"] {
    color: var(--text-primary);
  }

  /* Post metadata and text elements */
  .post-meta,
  .page-meta {
    color: var(--text-secondary);
  }

  /* Badges */
  .badge {
    &.bg-secondary {
      background-color: #495057 !important;
      color: var(--text-primary);
    }

    &.bg-light {
      background-color: var(--bg-secondary) !important;
      color: var(--text-primary) !important;
    }

    &.bg-success {
      background-color: #198754 !important;
      color: #ffffff !important;
    }

    &.bg-danger {
      background-color: #dc3545 !important;
      color: #ffffff !important;
    }

    &.bg-warning {
      background-color: #ffc107 !important;
      color: #000000 !important;
    }

    &.bg-info {
      background-color: #0dcaf0 !important;
      color: #000000 !important;
    }
  }

  /* Outline badges */
  .badge.bg-outline-secondary {
    background-color: transparent !important;
    border: 1px solid var(--border-color);
    color: var(--text-secondary) !important;
  }

  /* List groups */
  .list-group-item {
    background-color: var(--card-bg);
    color: var(--text-primary);
    border-color: var(--border-color);
  }

  /* Ensure proper contrast for white text elements that remain white */
  .text-white {
    color: #ffffff !important;
  }

  .text-white-50 {
    color: rgba(255, 255, 255, 0.5) !important;
  }

  /* Container backgrounds */
  .container {
    background-color: transparent;
  }

  /* Close buttons in alerts */
  .btn-close {
    filter: invert(1) grayscale(100%) brightness(200%);
  }

  /* ============================================
     MANAGEMENT INTERFACE DARK MODE
     ============================================ */

  /* Management body background */
  body.bg-light {
    background-color: var(--bg-primary) !important;
  }

  /* Sidebar */
  .sidebar {
    background-color: var(--bg-secondary) !important;
    border-color: var(--border-color) !important;

    .nav-link {
      color: var(--text-secondary);

      &:hover {
        background-color: rgba(255, 255, 255, 0.05);
        color: var(--text-primary);
      }

      &.active {
        background-color: rgba(255, 255, 255, 0.1);
        color: var(--text-primary);
        font-weight: 600;
      }

      i {
        color: var(--text-secondary);
      }

      &.active i,
      &:hover i {
        color: var(--text-primary);
      }
    }

    hr {
      border-color: var(--border-color);
      opacity: 0.3;
    }
  }

  /* Management navbar */
  .navbar.bg-primary {
    background-color: #1a1a1a !important;
    border-bottom: 1px solid var(--border-color);
  }

  /* Tables */
  .table {
    --bs-table-bg: var(--bg-primary);
    --bs-table-color: var(--text-primary);
    --bs-table-border-color: var(--border-color);
    --bs-table-striped-bg: rgba(255, 255, 255, 0.02);
    --bs-table-striped-color: var(--text-primary);
    --bs-table-active-bg: rgba(255, 255, 255, 0.05);
    --bs-table-active-color: var(--text-primary);
    --bs-table-hover-bg: rgba(255, 255, 255, 0.075);
    --bs-table-hover-color: var(--text-primary);

    color: var(--text-primary);
    background-color: var(--bg-primary);
    border-color: var(--border-color);

    thead {
      background-color: var(--bg-secondary) !important;
      color: var(--text-primary) !important;
      border-color: var(--border-color);

      th {
        color: var(--text-primary) !important;
        border-color: var(--border-color);
        background-color: var(--bg-secondary) !important;
      }
    }

    tbody {
      background-color: var(--bg-primary);

      tr {
        border-color: var(--border-color);
        background-color: var(--bg-primary);

        &:hover {
          background-color: rgba(255, 255, 255, 0.075) !important;
        }
      }

      td {
        color: var(--text-primary) !important;
        border-color: var(--border-color);
        background-color: transparent;

        a {
          color: var(--link-color);

          &:hover {
            color: var(--link-hover-color);
          }
        }
      }
    }

    // Striped rows
    &.table-striped {
      tbody tr:nth-of-type(odd) {
        background-color: rgba(255, 255, 255, 0.02) !important;
      }
    }

    // Bordered tables
    &.table-bordered {
      border-color: var(--border-color);

      th,
      td {
        border-color: var(--border-color);
      }
    }
  }

  .table-light {
    --bs-table-bg: var(--bg-secondary);
    --bs-table-color: var(--text-primary);
    background-color: var(--bg-secondary) !important;
    color: var(--text-primary) !important;

    th,
    td {
      background-color: var(--bg-secondary) !important;
      color: var(--text-primary) !important;
    }
  }

  .table-dark {
    --bs-table-bg: #1a1a1a;
    --bs-table-color: var(--text-primary);
    background-color: #1a1a1a !important;
    color: var(--text-primary) !important;
  }

  .table-hover tbody tr:hover {
    background-color: rgba(255, 255, 255, 0.075) !important;
    color: var(--text-primary) !important;
  }

  // Table responsive wrapper
  .table-responsive {
    border-color: var(--border-color);
  }

  /* Buttons in management interface */
  .btn-light {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);

    &:hover {
      background-color: var(--border-color);
      color: var(--text-primary);
      border-color: var(--border-color);
    }

    i {
      color: var(--text-secondary);
    }

    &:hover i {
      color: var(--text-primary);
    }
  }

  .btn-primary {
    background-color: #0d6efd;
    border-color: #0d6efd;
    color: #ffffff;

    &:hover {
      background-color: #0b5ed7;
      border-color: #0a58ca;
    }
  }

  .btn-outline-primary {
    color: var(--link-color);
    border-color: var(--link-color);

    &:hover {
      background-color: var(--link-color);
      color: #ffffff;
    }
  }

  /* Form controls in management */
  .form-control,
  .form-select,
  textarea.form-control {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);

    &:focus {
      background-color: var(--bg-secondary);
      color: var(--text-primary);
      border-color: var(--link-color);
      box-shadow: 0 0 0 0.25rem rgba(110, 168, 254, 0.25);
    }

    &::placeholder {
      color: var(--text-muted);
    }
  }

  /* Form labels */
  .form-label {
    color: var(--text-primary);
  }

  .form-text {
    color: var(--text-secondary);
  }

  /* Form check (checkboxes and radios) */
  .form-check-input {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);

    &:checked {
      background-color: var(--link-color);
      border-color: var(--link-color);
    }

    &:focus {
      border-color: var(--link-color);
      box-shadow: 0 0 0 0.25rem rgba(110, 168, 254, 0.25);
    }
  }

  .form-check-label {
    color: var(--text-primary);
  }

  /* Input groups */
  .input-group-text {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);
  }

  /* Card headers and titles in forms */
  .card-title {
    color: var(--text-primary);
  }

  .card-subtitle {
    color: var(--text-secondary);
  }

  .card-header {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);
  }

  .card-footer {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);
  }

  /* Trix editor (if used) */
  trix-editor {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);

    &:focus {
      border-color: var(--link-color);
    }
  }

  trix-toolbar {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);

    .trix-button-group {
      border-color: var(--border-color);

      button {
        color: var(--text-primary);
        border-color: var(--border-color);

        &:hover {
          background-color: var(--border-color);
        }

        &.trix-active {
          background-color: var(--border-color);
        }
      }
    }
  }

  /* Modals */
  .modal-content {
    background-color: var(--card-bg);
    color: var(--text-primary);
    border-color: var(--border-color);
  }

  .modal-header {
    border-color: var(--border-color);

    .modal-title {
      color: var(--text-primary);
    }
  }

  .modal-body {
    color: var(--text-primary);
  }

  .modal-footer {
    border-color: var(--border-color);
  }

  /* Tooltips and popovers */
  .tooltip-inner {
    background-color: var(--card-bg);
    color: var(--text-primary);
  }

  .popover {
    background-color: var(--card-bg);
    border-color: var(--border-color);
  }

  .popover-header {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);
  }

  .popover-body {
    color: var(--text-primary);
  }

  /* Nav tabs */
  .nav-tabs {
    border-color: var(--border-color);

    .nav-link {
      color: var(--text-secondary);
      border-color: transparent;

      &:hover {
        color: var(--text-primary);
        border-color: var(--border-color) var(--border-color) transparent;
      }

      &.active {
        color: var(--text-primary);
        background-color: var(--bg-primary);
        border-color: var(--border-color) var(--border-color) var(--bg-primary);
      }
    }
  }

  /* Nav pills */
  .nav-pills {
    .nav-link {
      color: var(--text-secondary);

      &:hover {
        color: var(--text-primary);
        background-color: rgba(255, 255, 255, 0.05);
      }

      &.active {
        background-color: var(--link-color);
        color: #ffffff;
      }
    }
  }

  /* Breadcrumb */
  .breadcrumb {
    background-color: var(--bg-secondary);

    .breadcrumb-item {
      color: var(--text-secondary);

      a {
        color: var(--link-color);

        &:hover {
          color: var(--link-hover-color);
        }
      }

      &.active {
        color: var(--text-primary);
      }

      &::before {
        color: var(--text-muted);
      }
    }
  }

  /* Progress bars */
  .progress {
    background-color: var(--bg-secondary);
  }

  /* Spinners */
  .spinner-border,
  .spinner-grow {
    color: var(--link-color);
  }

  /* Accordion */
  .accordion {
    .accordion-item {
      background-color: var(--card-bg);
      border-color: var(--border-color);
    }

    .accordion-header {
      .accordion-button {
        background-color: var(--bg-secondary);
        color: var(--text-primary);

        &:not(.collapsed) {
          background-color: var(--border-color);
          color: var(--text-primary);
        }

        &:focus {
          border-color: var(--link-color);
          box-shadow: 0 0 0 0.25rem rgba(110, 168, 254, 0.25);
        }
      }
    }

    .accordion-body {
      color: var(--text-primary);
    }
  }

  /* Offcanvas */
  .offcanvas {
    background-color: var(--card-bg);
    color: var(--text-primary);
  }

  .offcanvas-header {
    border-color: var(--border-color);
  }

  .offcanvas-title {
    color: var(--text-primary);
  }

  /* Toast notifications */
  .toast {
    background-color: var(--card-bg);
    color: var(--text-primary);
    border-color: var(--border-color);
  }

  .toast-header {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);
  }

  .toast-body {
    color: var(--text-primary);
  }

  /* Management-specific utility overrides */
  body.bg-light {

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      color: var(--text-primary);
    }

    p {
      color: var(--text-primary);
    }

    .text-dark {
      color: var(--text-primary) !important;
    }

    .text-muted {
      color: var(--text-secondary) !important;
    }
  }

  /* Border utilities */
  .border-bottom {
    border-color: var(--border-color) !important;
  }

  .border-top {
    border-color: var(--border-color) !important;
  }

  .border-start {
    border-color: var(--border-color) !important;
  }

  .border-end {
    border-color: var(--border-color) !important;
  }

  .border {
    border-color: var(--border-color) !important;
  }

  /* Additional utility overrides */
  .text-bg-light {
    background-color: var(--bg-secondary) !important;
    color: var(--text-primary) !important;
  }

  .text-bg-dark {
    background-color: #000000 !important;
    color: var(--text-primary) !important;
  }

  .text-bg-secondary {
    background-color: #495057 !important;
    color: var(--text-primary) !important;
  }

  /* Ensure dividers are visible */
  .vr {
    background-color: var(--border-color);
    opacity: 1;
  }

  /* Grid and container backgrounds */
  .row {
    color: var(--text-primary);
  }

  .col,
  [class*="col-"] {
    color: var(--text-primary);
  }

  /* Shadow adjustments for dark mode */
  .shadow-sm {
    box-shadow: 0 0.125rem 0.25rem rgba(255, 255, 255, 0.075) !important;
  }

  .shadow {
    box-shadow: 0 0.5rem 1rem rgba(255, 255, 255, 0.15) !important;
  }

  /* File upload areas */
  input[type="file"] {
    color: var(--text-primary);

    &::file-selector-button {
      background-color: var(--bg-secondary);
      color: var(--text-primary);
      border-color: var(--border-color);

      &:hover {
        background-color: var(--border-color);
      }
    }
  }
}

/* Transparent navbar over hero images */
.navbar.bg-transparent {
  background: transparent !important;
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
  top: 0 !important;
  margin: 0 !important;
}

/* Navbar without hero - match body background */
.navbar.bg-dark:not(.bg-transparent) {
  background: white !important;
}

.navbar.bg-dark:not(.bg-transparent) .navbar-brand {
  color: #333 !important;
}

.navbar.bg-dark:not(.bg-transparent) .nav-link {
  color: #666 !important;
  font-weight: 500 !important;
}

.navbar.bg-dark:not(.bg-transparent) .nav-link:hover {
  color: #333 !important;
}

/* Prevent horizontal scrolling on mobile */
html,
body {
  overflow-x: hidden;
}

/* Transparent navbar over hero images */
.navbar.bg-transparent {
  background: transparent !important;
  backdrop-filter: blur(5px);
  transition: all 0.3s ease;
  top: 0 !important;
  margin: 0 !important;
}

.navbar.bg-transparent .container {
  display: flex !important;
  align-items: baseline !important;
}

.navbar.bg-transparent .navbar-brand {
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.navbar.bg-transparent .navbar-collapse {
  background: transparent;
  border-radius: 8px;
  margin-top: 0 !important;
  padding: 0 !important;
}

.navbar.bg-transparent .navbar-nav {
  margin-top: 4px !important;
  align-items: baseline !important;
}

.navbar.bg-transparent .nav-link {
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
  color: rgba(255, 255, 255, 1) !important;
  font-weight: 500 !important;
}

.navbar.bg-transparent .nav-link:hover {
  color: rgba(255, 255, 255, 1) !important;
  text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.9);
}

.navbar.bg-transparent .navbar-toggler {
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.navbar.bg-transparent .navbar-collapse {
  background: transparent;
  border-radius: 8px;
  margin-top: 10px;
  padding: 15px;
}

/* Global font styling with Mulish */
body {
  font-family: 'Mulish', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  font-size: 1.125rem;
  /* Optimized base font size for Mulish readability */
  line-height: 1.6;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: 'Mulish', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  font-weight: 600;
}

.navbar-brand {
  font-family: 'Mulish', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  font-weight: 700;
}

.nav-link {
  font-family: 'Mulish', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}

/* Management interface styling with Mulish */
body.bg-light {
  font-family: 'Mulish', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  font-size: 1rem;
  /* Standard size for admin interface */
  line-height: 1.5;
}

body.bg-light h1,
body.bg-light h2,
body.bg-light h3,
body.bg-light h4,
body.bg-light h5,
body.bg-light h6 {
  font-family: 'Mulish', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  font-weight: 600;
}

body.bg-light .navbar-brand {
  font-family: 'Mulish', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  font-weight: 700;
}

body.bg-light .nav-link {
  font-family: 'Mulish', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}

/* Lexxy prompt customizations */
.lexxy-prompt-menu__item {

  /* Make sure img is properly positioned */
  img {
    flex-shrink: 0 !important;
    margin: 0 !important;
    border-radius: 0% !important;
  }
}

/* Lexxy toolbar fixes for Bootstrap compatibility */
lexxy-toolbar {
  align-items: center;

  .lexxy-editor__toolbar-button {
    display: grid;
    place-items: center;
    padding: 0;
    line-height: 1;

    svg {
      display: block;
      vertical-align: middle;
    }
  }

  /* Hide dropdown markers */
  summary {
    list-style: none;

    &::marker,
    &::-webkit-details-marker {
      display: none;
    }
  }

  /* Ensure dropdowns align properly */
  .lexxy-editor__toolbar-dropdown {
    display: flex;
    align-items: center;
  }
}

/* ==========================================================================
   Lexxy / Bootstrap Compatibility Fixes
   
   Bootstrap applies aggressive default styles that conflict with lexxy.
   These overrides ensure lexxy components render correctly.
   ========================================================================== */

/* Editor container fixes */
lexxy-editor {
  /* Reset Bootstrap's box-sizing if it affects the editor */
  box-sizing: border-box;
  
  /* Ensure buttons inside editor don't get Bootstrap styling */
  button,
  summary {
    /* Reset Bootstrap button defaults */
    border: none;
    
    &:focus {
      box-shadow: none; /* Remove Bootstrap focus glow */
    }
  }

  /* Reset Bootstrap input styles inside dropdowns */
  input[type="url"],
  input[type="text"] {
    box-shadow: none;
    
    &:focus {
      box-shadow: none;
      border-color: var(--lexxy-color-ink-lighter);
    }
  }
}

/* Table fixes - Bootstrap applies aggressive table styles */
lexxy-editor,
.lexxy-content {
  table {
    /* Reset Bootstrap table CSS variables */
    --bs-table-bg: transparent;
    --bs-table-color: inherit;
    --bs-table-border-color: var(--lexxy-color-ink-lighter, #dee2e6);
    --bs-table-striped-bg: transparent;
    --bs-table-hover-bg: transparent;
    --bs-table-active-bg: transparent;
    
    /* Ensure lexxy styles take precedence */
    border-collapse: collapse;
    border-spacing: 0;
    margin-bottom: 0; /* Bootstrap adds margin-bottom: 1rem */
    vertical-align: top;
    caption-side: bottom;
    
    /* Let lexxy control width - use inline-size for proper sizing */
    width: unset;
    inline-size: calc(100% - 0.5ch);
    margin: 0.25ch;

    th,
    td {
      border: 1px solid var(--lexxy-color-ink-lighter, #dee2e6);
      padding: 1ch;
      text-align: start;
      background-color: transparent;
      vertical-align: top;
      /* Reset Bootstrap's td/th padding */
      box-shadow: none;
    }
    
    /* Header cell styling */
    .lexxy-content__table-cell--header {
      background-color: var(--lexxy-color-ink-lightest, #f8f9fa);
      font-weight: bold;
    }
  }
}

/* Table handler buttons (the floating row/column controls) */
.lexxy-table-handle-buttons {
  z-index: 10;
  
  /* Reset Bootstrap button styles inside handler */
  button {
    all: unset;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    aspect-ratio: 1 / 1;
    min-block-size: var(--button-size, 2.5lh);
    min-inline-size: var(--button-size, 2.5lh);
    background-color: transparent;
    border-radius: var(--lexxy-radius, 0.5ch);
    color: var(--lexxy-color-ink-inverted, white);
    
    &:hover {
      background-color: var(--lexxy-color-ink-medium, #666);
    }
    
    &:focus {
      box-shadow: none;
      outline: var(--lexxy-focus-ring-size, 2px) solid var(--lexxy-focus-ring-color);
    }
  }
  
  /* More menu details button needs different aspect ratio */
  .lexxy-table-control__more-menu-details button {
    aspect-ratio: unset;
  }
}

/* Table dropdown in toolbar */
lexxy-table-dropdown {
  button {
    border-radius: 0;
    font-family: inherit;
    
    &:focus {
      box-shadow: none;
    }
  }
  
  /* Checkbox label alignment */
  label {
    margin-bottom: 0; /* Bootstrap adds margin-bottom to labels */
  }
  
  input[type="checkbox"] {
    margin: 0;
  }
}

/* Link dropdown fixes */
lexxy-link-dropdown {
  button {
    /* Ensure buttons display inline properly */
    display: inline-flex;
    justify-content: center;
    
    &:focus {
      box-shadow: none;
    }
  }
  
  input[type="url"] {
    /* Reset Bootstrap form-control styles */
    box-shadow: none;
    
    &:focus {
      box-shadow: none;
      outline: none;
    }
  }
}

/* Highlight (color picker) dropdown fixes */
lexxy-highlight-dropdown {
  button {
    /* Reset Bootstrap button defaults */
    border: none;
    
    &:focus {
      box-shadow: none;
    }
  }
}

/* Code language picker fixes */
.lexxy-code-language-picker {
  /* Reset Bootstrap select styles */
  box-shadow: none;
  
  &:focus {
    box-shadow: none;
    outline: var(--lexxy-focus-ring-size, 2px) solid var(--lexxy-focus-ring-color);
  }
}

/* Prompt menu (mentions dropdown) fixes */
.lexxy-prompt-menu {
  /* Reset Bootstrap list styles */
  padding-left: 0 !important;
  margin-bottom: 0;
  
  /* Reset Bootstrap list-group if applied */
  list-style: none;
  
  li,
  .lexxy-prompt-menu__item {
    /* Reset Bootstrap list-group-item styles */
    border: none;
    background-color: transparent;
    padding: var(--lexxy-prompt-padding, 0.5ch);
    
    &:hover {
      background-color: var(--lexxy-color-ink-lightest);
    }
    
    &[aria-selected] {
      background-color: var(--lexxy-color-selected);
    }
  }
}

/* Attachment styling fixes */
.lexxy-content {
  .attachment,
  action-text-attachment {
    /* Reset Bootstrap figure styles */
    margin-bottom: 0;
    
    /* Ensure images don't get Bootstrap's max-width: 100% applied wrongly */
    img {
      max-width: 100%;
      height: auto;
    }
  }
  
  /* Caption textarea */
  .attachment__caption textarea {
    /* Reset Bootstrap form-control styles */
    box-shadow: none;
    
    &:focus {
      box-shadow: none;
      outline: none;
    }
  }
}

/* Blockquote fixes - Bootstrap styles blockquotes */
.lexxy-content blockquote {
  /* Reset Bootstrap blockquote styles */
  margin-bottom: 0;
  font-size: inherit; /* Bootstrap increases blockquote font-size */
}

/* Code block fixes */
.lexxy-content {
  code,
  pre {
    /* Reset Bootstrap code/pre styles */
    font-size: 0.9em; /* Bootstrap uses different size */
    color: var(--lexxy-color-ink);
  }
  
  pre {
    /* Bootstrap adds margin-bottom to pre */
    margin-bottom: 0;
  }
}

/* Horizontal divider fixes */
.lexxy-content .horizontal-divider hr {
  /* Reset Bootstrap hr styles */
  opacity: 1;
  background-color: transparent;
  border: 0;
  border-block-end: 1px solid currentColor;
  margin: 0;
}

/* List fixes - Bootstrap modifies ul/ol styles */
.lexxy-content {
  ul,
  ol {
    /* Let lexxy control list styling */
    padding-left: 2em; /* Reasonable default, lexxy uses default browser */
  }
}

/* Heading fixes - Bootstrap modifies heading margins */
.lexxy-content {
  h1, h2, h3, h4, h5, h6 {
    /* Reset Bootstrap heading margins */
    margin-top: 0;
    margin-bottom: var(--lexxy-content-margin, 1rem);
  }
}

/* Cover Image Hero Section */
.hero-section {
  height: 60vh;
  min-height: 400px;
  overflow: hidden;
  width: 100%;
}

.hero-image {
  height: 110%;
  /* Make image slightly taller to accommodate parallax movement */
  transform: translateY(-5%);
  /* Start with image slightly higher, but less aggressive */
}

.hero-bg {
  height: 100%;
  object-fit: cover;
  object-position: center center;
  will-change: transform;
  display: block;
  /* Ensure no inline spacing */
}

.hero-overlay {
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.3) 70%, rgba(0, 0, 0, 0.7) 100%);
}

.hero-title {
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
  line-height: 1.2;
}

.hero-subtitle {
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.post-meta.text-white-50,
.page-meta.text-white-50 {
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
}

/* Attribution overlay */
.attribution {
  backdrop-filter: blur(4px);
  font-size: 0.75rem;

  a {
    color: inherit !important;
    text-decoration: underline;
  }

  a:hover {
    color: inherit !important;
    text-decoration: underline;
    opacity: 0.8;
  }
}

/* Responsive adjustments and mobile fixes */
@media (max-width: 768px) {
  .hero-section {
    height: 50vh;
    min-height: 300px;
    margin-bottom: 0;
    /* Ensure no extra spacing */
  }

  .hero-image {
    /* Maintain consistent behavior on mobile */
    height: 110%;
    transform: translateY(-5%);
  }

  /* Make mobile navbar collapse more visible over hero */
  .navbar.bg-transparent .navbar-collapse {
    background: transparent;
    backdrop-filter: blur(15px);
  }

  .hero-title {
    font-size: 2rem !important;
  }

  /* Ensure containers don't overflow */
  .container-fluid {
    overflow-x: hidden;
  }

  /* Fix potential width issues */
  .row {
    margin-left: 0;
    margin-right: 0;
  }

  /* Ensure images stay within bounds */
  img {
    max-width: 100%;
    height: auto;
  }

  /* Fix pre and code blocks */
  pre,
  code {
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }
}

/* Lexxy content styling */
.lexxy-content {
  figure {
    margin: 1.5rem auto;
    text-align: center;
  }

  img {
    display: block;
    margin: 1.5rem auto;
    max-width: 100%;
    height: auto;
  }

  code {
    font-family: 'Sometype Mono', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    font-size: 0.9em;
    background-color: rgba(0, 0, 0, 0.04);
    padding: 0.2em 0.4em;
    border-radius: 0.25rem;
  }
}

/* Action Text attachment styling */
.attachment {
  margin: 1.5rem auto;
  text-align: center;

  &--video {
    video {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      background-color: #000;
      display: block;

      // iPhone/iOS specific optimizations
      -webkit-playsinline: true;
      -webkit-appearance: none;
      appearance: none;

      // Force iPhone to respect playsinline
      &[playsinline] {
        -webkit-playsinline: true;
        object-fit: contain;
      }

      // Ensure controls are properly visible on iPhone
      &::-webkit-media-controls {
        display: flex !important;
        opacity: 1 !important;
      }

      &::-webkit-media-controls-panel {
        background-color: rgba(0, 0, 0, 0.8);
        border-radius: 4px;
        display: flex !important;
      }

      &::-webkit-media-controls-play-button {
        display: block !important;
        opacity: 1 !important;
      }

      &::-webkit-media-controls-start-playback-button {
        display: block !important;
        opacity: 1 !important;
      }

      // iPhone Safari specific fixes
      @supports (-webkit-touch-callout: none) {
        min-height: 200px;

        &:not([controls]) {
          pointer-events: auto;
        }
      }

      // Mobile responsive enhancements
      @media (max-width: 768px) {
        border-radius: 6px;
        margin: 1rem 0;
        width: 100% !important;
        height: auto !important;
      }
    }

    // iOS play button overlay
    .ios-video-play-button {
      &:hover {
        opacity: 0.9;
      }

      svg circle {
        transition: all 0.2s ease;
      }

      &:hover svg circle {
        fill: rgba(0, 0, 0, 0.8);
      }
    }
  }

  &__caption {
    margin-top: 0.5rem;
    font-style: italic;
    color: #6c757d;
    font-size: 0.9rem;
  }
}

/* Scroll behavior and layout shift prevention */
html {
  scroll-behavior: auto !important;
  /* Disable smooth scrolling for instant positioning */
}

/* Prevent layout shifts during image loading */
.loading-image {
  background-color: #f8f9fa;
  min-height: 200px;
  background-image: linear-gradient(90deg, #f0f0f0 25%, transparent 25%),
    linear-gradient(#f0f0f0 50%, transparent 50%);
  background-size: 20px 20px;
  background-position: 0 0, 10px 10px;
}

/* Hero image improvements - better centering and scaling */
.hero-bg {
  object-fit: cover;
  object-position: center center;
  /* Vertically and horizontally centered */
  width: 100%;
  height: 100%;
}

/* Turbo-specific optimizations */
body[data-turbo-preview] {
  /* Hide content during turbo preview to prevent flash */
  visibility: hidden;
}

/* Force immediate scroll position reset */
body:not([data-turbo-preview]) {
  visibility: visible;
}