-  - if attachable.video?
    %figure.attachment.attachment--preview.attachment--video{style: "position: relative;", data: {controller: "ios-video"}}
      %video{controls: "controls", playsinline: "playsinline", "webkit-playsinline": "webkit-playsinline", preload: "metadata", "x-webkit-airplay": "allow", muted: "muted", style: "max-width: 100%; height: auto; border-radius: 8px; display: block; background-color: #000;"}
        - # iPhone-optimized source ordering - MP4 first
        - if attachable.content_type.include?('mp4') || attachable.content_type == 'video/mp4'
          %source{src: url_for(attachable), type: "video/mp4"}
        - elsif attachable.content_type.include?('webm') || attachable.content_type == 'video/webm'
          %source{src: url_for(attachable), type: "video/webm"}
        - elsif attachable.content_type.include?('ogg') || attachable.content_type == 'video/ogg'
          %source{src: url_for(attachable), type: "video/ogg"}
        - else
          %source{src: url_for(attachable), type: attachable.content_type}
        Your browser does not support the video tag.ble.is_a?(ActiveStorage::Blob)
  - if attachable.video?
    %figure.attachment.attachment--preview.attachment--video{style: "position: relative;", data: {controller: "ios-video"}}
      %video{style: "max-width: 100%; height: auto; border-radius: 8px; display: block;"}
        %source{src: url_for(attachable), type: attachable.content_type}
        - if attachable.content_type.include?('mp4')
          %source{src: url_for(attachable), type: "video/mp4"}
        - if attachable.content_type.include?('webm')
          %source{src: url_for(attachable), type: "video/webm"}
        - if attachable.content_type.include?('ogg')
          %source{src: url_for(attachable), type: "video/ogg"}
        Your browser does not support the video tag.
      - if caption.present?
        %figcaption.attachment__caption= caption
  - elsif attachable.representable?
    %figure.attachment.attachment--preview.attachment--image
      = image_tag attachable.representation(resize_to_limit: [800, 600]), style: "max-width: 100%; height: auto;"
      - if caption.present?
        %figcaption.attachment__caption= caption
  - else
    %figure.attachment.attachment--file
      = link_to url_for(attachable), target: "_blank", class: "btn btn-outline-primary" do
        %i.bi.bi-download.me-2
        = attachable.filename
- else
  %figure.attachment
    = link_to url_for(attachable), target: "_blank" do
      = attachable.to_s