- content_for :title, 'Edit Menu Item'

.d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center.pt-3.pb-2.mb-3.border-bottom
  %h1.h2 
    Edit Menu Item
    %small.text-muted= @menu_item.page.title
  .btn-toolbar.mb-2.mb-md-0
    = link_to manage_menu_items_path, class: 'btn btn-outline-secondary' do
      %i.bi.bi-arrow-left.me-2
      Back to Menu

= form_with model: [:manage, @menu_item], local: true, class: 'needs-validation', novalidate: true do |form|
  - if @menu_item.errors.any?
    .alert.alert-danger.mb-4
      %h5.alert-heading
        %i.bi.bi-exclamation-triangle.me-2
        = pluralize(@menu_item.errors.count, "error")
        prohibited this menu item from being saved:
      %ul.mb-0
        - @menu_item.errors.each do |error|
          %li= error.full_message

  .row
    .col-lg-8
      .card.border-0.shadow-sm
        .card-header.bg-white.border-0.pb-0
          %h6.card-title.text-dark.mb-0
            %i.bi.bi-pencil.me-2
            Menu Item Details
        .card-body.pt-3
          .mb-4
            = form.label :page_id, "Select Page", class: "form-label"
            = form.select :page_id, 
                options_from_collection_for_select(@available_pages, :id, :title, @menu_item.page_id),
                {},
                { class: "form-select", required: true }
            .form-text.text-muted
              The page title will be used as the menu item name.

          .row
            .col-md-6
              .mb-3
                = form.label :position, "Position", class: "form-label"
                = form.number_field :position, class: "form-control", min: 1, required: true
                .form-text.text-muted
                  Lower numbers appear first in the menu.
            .col-md-6
              .mb-3
                .form-check.form-switch.mt-4
                  = form.check_box :enabled, class: "form-check-input", role: "switch"
                  = form.label :enabled, "Enable menu item", class: "form-check-label"

    .col-lg-4
      .card.border-0.shadow-sm
        .card-body
          %h6.mb-3 Update Menu Item
          %p.small.text-muted
            Save changes to this menu item.
          
          = form.submit "Update Menu Item", class: "btn btn-primary w-100 mb-2"
          = link_to "Cancel", manage_menu_items_path, class: "btn btn-outline-secondary w-100 mb-2"
          = link_to "Remove from Menu", [:manage, @menu_item], method: :delete, 
              data: { confirm: "Are you sure you want to remove this item from the menu?" },
              class: "btn btn-outline-danger w-100"

      .card.border-0.shadow-sm.mt-4
        .card-header.bg-white.border-0.pb-0
          %h6.card-title.text-dark.mb-0
            %i.bi.bi-info-circle.me-2
            Current Position
        .card-body.pt-3
          %p.small.text-muted
            %strong Position:
            = @menu_item.position
          %p.small.text-muted
            %strong Status:
            - if @menu_item.enabled?
              %span.badge.bg-success Enabled
            - else
              %span.badge.bg-secondary Disabled