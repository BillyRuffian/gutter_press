- content_for :title, 'Manage Posts'

.d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center.pt-3.pb-2.mb-3.border-bottom
  %h1.h2 Posts
  = link_to new_manage_post_path, class: 'btn btn-primary' do
    %i.bi.bi-plus-circle.me-2
    New Post

- if @posts.any?
  .card.border-0.shadow-sm
    .table-responsive
      %table.table.table-hover.mb-0
        %thead.table-light
          %tr
            %th{style: 'width: 40%'} Title
            %th{style: 'width: 15%'} Publish
            %th{style: 'width: 25%'} Publish Date
            %th.text-center{style: 'width: 10%'} Live
            %th.text-end{style: 'width: 10%'} Actions
        %tbody
          - @posts.each do |post|
            %tr
              %td
                = link_to post.title, edit_manage_post_path(post)
                - unless post.published?
                  %span.badge.bg-secondary.ms-2 Draft
              %td
                - if post.publish?
                  %span.badge.bg-success Yes
                - else
                  %span.badge.bg-outline-secondary No
              %td
                - if post.publish? && post.published_at
                  = post.published_at.to_formatted_s(:long)
                - elsif post.publish?
                  %span.text-muted Not set
                - else
                  %span.text-muted N/A
              %td.text-center
                - if post.published?
                  %i.bi.bi-check-circle.text-success{title: 'Published'}
                - else
                  %i.bi.bi-x-square.text-muted{title: 'Not published'}
              %td.text-end
                .btn-group{role: 'group'}
                  = link_to edit_manage_post_path(post), class: 'btn btn-light btn-sm border-0', title: 'Edit' do
                    %i.bi.bi-pencil.text-muted
                  = button_to manage_post_path(post), method: :delete, 
                      class: 'btn btn-light btn-sm border-0',
                      title: 'Delete',
                      data: { turbo_confirm: 'Are you sure you want to delete this post?' },
                      form: {class: 'd-inline'} do
                    %i.bi.bi-trash.text-muted
  
  .d-flex.justify-content-between.align-items-center.mt-3
    .text-muted.small
      Showing #{@pagy.from}-#{@pagy.to} of #{@pagy.count} posts
    = raw pagy_bootstrap_nav(@pagy) if @pagy.pages > 1
- else
  .card.border-0.shadow-sm
    .card-body.text-center.py-5
      %i.bi.bi-journal-text.display-1.text-muted.mb-3
      %h3.text-muted No posts yet
      %p.text-muted Start writing your first blog post!
      = link_to 'Create your first post', new_manage_post_path, class: 'btn btn-primary'