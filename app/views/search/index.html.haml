- content_for :title, @query.present? ? "Search results for \"#{@query}\"" : "Search"

.container.my-4
  .row
    .col-lg-8.mx-auto
      .d-flex.justify-content-between.align-items-center.mb-4
        %h1.h2
          - if @query.present?
            Search Results
            %small.text-muted= "for \"#{@query}\""
          - else
            Search
        
        - if @query.present? && @results_count > 0
          %small.text-muted
            = pluralize(@results_count, 'result')
            - if @pagy.pages > 1
              â€¢ showing #{@pagy.from}-#{@pagy.to}
      
      = form_with url: search_path, method: :get, local: true, class: "mb-4" do |form|
        .input-group.input-group-lg
          = form.text_field :q, value: @query, placeholder: "Search posts and pages...", 
              class: "form-control", required: true, autofocus: @query.blank?
          = form.submit "Search", class: "btn btn-primary"
      
      - if @query.present?
        - if @results_count > 0
          .search-results
            - @results.each do |result|
              .card.border-0.shadow-sm.mb-4
                .card-body
                  .d-flex.justify-content-between.align-items-start.mb-2
                    %h5.card-title.mb-1
                      = link_to result[:url], class: "text-decoration-none" do
                        = raw result[:title]
                    %span.badge{class: result[:type] == 'post' ? 'bg-primary' : 'bg-success'}
                      = result[:type].capitalize
                  
                  - if result[:excerpt].present?
                    %p.card-text.text-muted.mb-2
                      = raw result[:excerpt]
                  
                  - if result[:content_snippet].present?
                    %p.card-text.small.mb-2
                      %strong Match:
                      = raw result[:content_snippet]
                  
                  %small.text-muted
                    - if result[:type] == 'post'
                      Published 
                      = result[:published_at].strftime('%B %d, %Y')
                    - else
                      Page
          
          - if @pagy.pages > 1
            .d-flex.justify-content-center.mt-4
              != pagy_bootstrap_nav(@pagy, params: { q: h(@query) })
        - else
          .text-center.py-5
            %i.bi.bi-search.display-1.text-muted.mb-3
            %h3.text-muted No results found
            %p.text-muted
              Try different keywords or check your spelling.
      
      - else
        .text-center.py-5
          %i.bi.bi-search.display-1.text-muted.mb-3
          %h3.text-muted Search Posts and Pages
          %p.text-muted
            Enter keywords to find relevant content across the site.
